import React from "react";
import axios from "axios";
import Location from "./Location";
import { Route, Redirect } from "react-router-dom";

class Trip extends React.Component {
	constructor(props) {
		super(props);

		this.state = {
			trip: props.trip
		};
		// console.log(this.state.trip);

		this.getTripData = this.getTripData.bind(this);
	}

	getTripData(e) {
		e.preventDefault();
		let that = this;
		let data = {};
		data.name = document.getElementById("trip-name").value;
		data.type = document.querySelector(
			'input[name = "trip-type"]:checked'
		).value;
		console.log(data);
		axios
			.post("/trip/addtrip", data)
			.then(function(response) {
				// console.log('testttt');
				// console.log(response.data);
				data.id = response.data.insertId;
				that.setState({ trip: data });
				that.props.setTripState(data);
			})
			.catch(function(error) {
				console.log(error);
			});
	}

	render() {
		if (this.state.trip.id) {
			// console.log(this.state.trip);
			// console.log(this.state.trip.id);
			// history.pushState(null, null, '/trip/'+"3"+'/addlocation');
			return <Location trip={this.state.trip} />;
		} else {
			return (
				<div id="trip-box" className="container">
					<div className="center-block text-center">
						<form id="add-trip" action="" onSubmit={}>
							<h3>Where are you currently?</h3>
							<p>Enter city name: </p>
							<fieldset>
								<input
									id="checkin"
									className="form-control"
									placeholder="Current City"
									type="text"
									minLength="3"
									tabIndex="1"
									required
									autoFocus
								/>
							</fieldset>
							<hr />
							<fieldset>
								<button
									name="submit"
									type="submit"
									className="btn btn-primary btn-square"
									id="contact-submit"
									data-submit="...Sending"
								>
									Submit
								</button>
							</fieldset>
						</form>
					</div>
					<hr />
				</div>
			);
		}
	}
}

export default Checkin;
